datasource db {
  provider = "postgresql"
}

generator client {
  provider     = "prisma-client-js"
  moduleFormat = "cjs"
}

model Product {
  id    BigInt  @id @default(autoincrement())
  code  String  @unique @db.VarChar(50)
  name  String  @db.VarChar(150)
  price Decimal @db.Decimal(10, 2)

  materials ProductRawMaterial[]

  @@map("product")
}

model RawMaterial {
  id            BigInt  @id @default(autoincrement())
  code          String  @unique @db.VarChar(50)
  name          String  @db.VarChar(150)
  stockQuantity Decimal @map("stock_quantity") @db.Decimal(10, 2)

  products ProductRawMaterial[]

  @@map("raw_material")
}

model ProductRawMaterial {
  id BigInt @id @default(autoincrement())

  productId     BigInt @map("product_id")
  rawMaterialId BigInt @map("raw_material_id")

  requiredQuantity Decimal @map("required_quantity") @db.Decimal(10, 2)

  product     Product     @relation(fields: [productId], references: [id], onDelete: Cascade)
  rawMaterial RawMaterial @relation(fields: [rawMaterialId], references: [id], onDelete: Cascade)

  @@unique([productId, rawMaterialId], map: "uk_product_raw_material")
  @@map("product_raw_material")
}